<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xxm.it.system.dao.ISellDao">
	
	<sql id="query_sell_sql">
		SELECT 
				t.sell_id as sellId,
				t.sell_name as sellName,
				t.company_name as companyName,
				t.working_group as workingGroup,
				t.phone as phone,
				t.address as address,
				t.create_date as createDate,
				t.last_update_date as  lastUpdateDate
	    FROM 
	    		xxm_user_sell_t t 
	    WHERE 1 = 1 
	</sql>
	
	<sql id="sell_select_condition">
		<if test="companyName != null and companyName != ''">
    		AND t.company_name like concat('%',#{companyName,jdbcType=VARCHAR},'%')
    	</if>
    	
    	<if test="address != null and address != ''">
    		AND t.address like concat('%',#{address,jdbcType=VARCHAR},'%')
    	</if>
	</sql>
	
	<!-- 查询经销商列表信息-->
	<select id="findSellList" resultType="com.xxm.it.system.vo.UserSellVO" parameterType="com.xxm.it.system.vo.UserSellVO">
		 <include refid="query_sell_sql"></include>
		 <include refid="sell_select_condition"></include>
		 AND status='0'
		order by t.create_date desc
		limit #{offset,jdbcType=VARCHAR},#{limit,jdbcType=VARCHAR}
	</select>
	
	
	<!-- 查询经销商信息-->
	<select id="findSellListCount" resultType="java.lang.Integer" parameterType="com.xxm.it.system.vo.UserSellVO">
		 SELECT count(sell_id)FROM xxm_user_sell_t t WHERE	1 = 1 AND STATUS = '0'
		 <include refid="sell_select_condition"></include>
	</select>
	
	<!-- 添加经销商信息 -->
	
	<insert id="addSell" parameterType="com.xxm.it.system.vo.UserSellVO">
		INSERT INTO xxm_user_sell_t(		
				sell_name,
				company_name,
				working_group,
				phone,
				address,
				status,
				create_date,
				last_update_date
			)VALUES(
				#{sellName,jdbcType=VARCHAR},
				#{companyName,jdbcType=VARCHAR},
				#{workingGroup,jdbcType=VARCHAR},
				#{phone,jdbcType=VARCHAR},
				#{address,jdbcType=VARCHAR},
				#{status,jdbcType=VARCHAR},
				now(),
				now()
		);
	</insert>
	
	
	<!-- 根据ID查询经销商详细信息 -->
	
	<select id="querySellId" resultType="com.xxm.it.system.vo.UserSellVO" parameterType="com.xxm.it.system.vo.UserSellVO">
		SELECT 
				t.sell_id as sellId,
				t.sell_name as sellName,
				t.company_name as companyName,
				t.working_group as workingGroup,
				t.phone as phone,
				t.address as address,
				t.create_date as createDate,
				t.last_update_date as  lastUpdateDate
		FROM 
			 	xxm_user_sell_t t
		WHERE t.sell_id = #{sellId,jdbcType=VARCHAR}
				
	</select>
	
	<!-- 修改经销商信息 -->
	<update id="updateSellInfo" parameterType="com.xxm.it.system.vo.UserSellVO">
		UPDATE xxm_user_sell_t t 
			SET
				t.sell_name =#{sellName,jdbcType=VARCHAR},
				t.company_name =#{companyName,jdbcType=VARCHAR},
				t.working_group =#{workingGroup,jdbcType=VARCHAR},
				t.phone =#{phone,jdbcType=VARCHAR},
				t.address =#{address,jdbcType=VARCHAR},
				t.last_update_date = NOW()
			
		WHERE 
				t.sell_id = #{sellId,jdbcType=VARCHAR}
			
	</update>
	
	<!-- 删除经销商信息 -->
	<delete id="deleteSellInfo" parameterType="com.xxm.it.system.vo.UserSellVO">
		UPDATE xxm_user_sell_t SET 
			status= 1
		WHERE sell_id in 
		<foreach collection="sellIds" item="item" index="index" separator="," open="(" close=")">  
			#{item}
		</foreach> 
	</delete>
	
</mapper>