<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xxm.it.system.dao.IMenuDao" >
	<sql id="query_menu_sql">
		  SELECT
			t.menu_id AS menuId,
			t.menu_name AS menuName,
			t.menu_path AS menuPath,
			t.menu_type AS menuType,
			t.parent_menu_id AS parentMenuId,
			t.menu_grade AS menuGrade,
			t.disabled_flag AS disabledFlag,
			t.sort_by as sortBy,
			t.remark as remark,
			t.extend_Field1 as extendField1,
			t.extend_Field2 as extendField2,
			t.extend_Field3 as extendField3,
			t.extend_Field4 as extendField4
		FROM
			xxm_menu_t t
		WHERE 1=1
	</sql>
	
	<!-- 查询所有栏目菜单 -->
	<select id="findMenus" resultType="com.xxm.it.system.vo.MenuVO" parameterType="com.xxm.it.system.vo.MenuVO">
		<include refid="query_menu_sql"></include>
		<if test="parentMenuId != null and parentMenuId !=''">
			AND t.parent_menu_id = #{parentMenuId,jdbcType=VARCHAR}
		</if>
		<if test="disabledFlag != null and disabledFlag !=''">
			AND t.disabled_flag= #{disabledFlag, jdbcType=VARCHAR}
		</if>
		order by t.sort_by
	</select>
	
	<!-- 根据id查询栏目菜单 -->
	<select id="findMenu" resultType="com.xxm.it.system.vo.MenuVO" parameterType="com.xxm.it.system.vo.MenuVO">
		 <include refid="query_menu_sql"></include>
		 AND t.menu_id=#{menuId,jdbcType=VARCHAR}
	</select>
	
	<!-- 增加栏目菜单 -->
	<insert id="addMenu" parameterType="com.xxm.it.system.vo.MenuVO">
		INSERT INTO xxm_menu_t (
			menu_name,
			menu_path,
			parent_menu_id,
			menu_type,
			create_by,
			create_date,
			last_update_by,
			last_update_date,
			disabled_flag,
			menu_grade,
			sort_by,
			remark,
			extend_Field1,
			extend_Field2,
			extend_Field3,
			extend_Field4
		)
		VALUES
		(
			#{menuName,jdbcType=VARCHAR},
			#{menuPath,jdbcType=VARCHAR},
			#{parentMenuId,jdbcType=VARCHAR},
			#{menuType,jdbcType=VARCHAR},
			#{createBy,jdbcType=VARCHAR},
			sysdate(),
			#{lastUpdateBy,jdbcType=VARCHAR},
			sysdate(),
			#{disabledFlag,jdbcType=VARCHAR},
			#{menuGrade,jdbcType=VARCHAR},
			99999,
			#{remark,jdbcType=VARCHAR},
			#{extendField1,jdbcType=VARCHAR},
			#{extendField2,jdbcType=VARCHAR},
			#{extendField3,jdbcType=VARCHAR},
			#{extendField3,jdbcType=VARCHAR}
		)
	</insert>
	
	<!-- 修改菜单 -->
	<update id="updateMenu">
		UPDATE xxm_menu_t SET 
			<if test="menuName != null and menuName !=''">
				menu_name = #{menuName,jdbcType=VARCHAR},
			</if>
			<if test="menuPath != null and menuPath !=''">
				menu_path = #{menuPath,jdbcType=VARCHAR},
			</if>
			<if test="menuType != null and menuType !=''">
				menu_type = #{menuType,jdbcType=VARCHAR},
			</if>
			<if test="disabledFlag != null and disabledFlag !=''">
				disabled_Flag = #{disabledFlag,jdbcType=VARCHAR},
			</if>
			<if test="parentMenuId != null and parentMenuId !=''">
				parent_menu_id = #{parentMenuId,jdbcType=VARCHAR},
			</if>
			<if test="sortBy != null and sortBy !=''">
				sort_by = #{sortBy,jdbcType=VARCHAR},
			</if>
			extend_Field1 = #{extendField1,jdbcType=VARCHAR},
			extend_Field2 = #{extendField2,jdbcType=VARCHAR},
			extend_Field3 = #{extendField3,jdbcType=VARCHAR},
			extend_Field4 = #{extendField4,jdbcType=VARCHAR},
			remark = #{remark,jdbcType=VARCHAR},
			last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
			last_update_date = sysdate()
		WHERE
			menu_id = #{menuId,jdbcType=VARCHAR}
	</update>
	
	<!-- 批量修改菜单顺序位置 -->
	<update id="updateBatchMenu">
		UPDATE xxm_menu_t SET 
			<if test="parentMenuId != null and parentMenuId !=''">
				parent_menu_id = #{parentMenuId,jdbcType=VARCHAR},
			</if>
			<if test="sortBy != null and sortBy !=''">
				sort_by = #{sortBy,jdbcType=VARCHAR},
			</if>
			last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
			last_update_date = sysdate()
		WHERE
			menu_id = #{menuId,jdbcType=VARCHAR}
	</update>
	
	<!-- 删除菜单 -->
	<delete id="deleteMenu" parameterType="com.xxm.it.system.vo.MenuVO">
		delete from xxm_menu_t WHERE menu_id = #{menuId,jdbcType=VARCHAR}
	</delete>
	
</mapper>