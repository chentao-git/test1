<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xxm.it.business.dao.IBaseCustomerDao" >
	<sql id="query_baseCustomer_sql">
		 SELECT
		 	b.Customer_Id AS customerId,
			t.base_Customer_Id AS baseCustomerId,
			t.base_Customer_Name AS baseCustomerName,
			t.base_Customer_Sex AS baseCustomerSex,
			getBaseDateNameByCode('BAQSNG_SEX',t.base_Customer_Sex,1) AS "baseCustomerSexName",
			t.cert_Type AS certType,
			getBaseDateNameByCode('BAQSNG_PAPER_TYPE',t.cert_Type,1) AS "certTypeName",
			t.cert_No AS certNo,
			t.issued_Date AS issuedDate,
			t.expiration_Date AS expirationDate,
			t.tax_Type AS taxType,
			t.marriage_Status AS marriageStatus,
			getBaseDateNameByCode('MARITAL_STATUS',t.marriage_Status,1) AS "marriageStatusName",
			t.spouse_Name AS spouseName,
			t.spouse_Id_Type AS spouseIdType,
			getBaseDateNameByCode('BAQSNG_PAPER_TYPE',t.spouse_Id_Type,1) AS "spouseIdTypeName",
			t.spouse_Id_No AS spouseIdNo,
			t.spouse_Mobile AS spouseMobile,
			t.education_Type AS educationType,
			getBaseDateNameByCode('EDUCATION_TYPE',t.education_Type,1) AS "educationTypeName",
			t.live_Addr AS liveAddr,
			t.live_City AS liveCity,
			t.company_Name AS companyName,
			t.position AS position,
			t.service_Year AS serviceYear,
			t.income AS income,
			t.company_Addr AS companyAddr,
			t.unit_Kind AS unitKind,
			t.mobile_No AS mobileNo,
			t.acc_No AS accNo,
			t.bank_Flag AS bankFlag,
			t.open_Bank_Name AS openBankName,
			getBaseDateNameByCode('LOAN_BANK',t.open_Bank_Name,1) AS "openBankBaseName",
			t.open_Bank_No AS openBankNo,
			t.cert_Image_File AS certImageFile,
			t.deductions_object_type AS deductionsObjectType,
			getBaseDateNameByCode('BANK_FLAG',t.deductions_object_type,1) AS "deductionsObjectTypeName",
			t.spouse_position AS spousePosition,
			t.census_register_place AS censusRegisterPlace,
			t.fixed_line AS fixedLine,
			t.birth_date AS birthDate,
			t.spouse_phone2 AS spousePhone2,
			t.account_name AS accountName,
			t.drawee_bank AS draweeBank,
			t.drawee_bank_account AS draweeBankAccount,
			t.drawee_bank_name AS draweeBankName,
			t.Large_line_No AS largeLineNo,
			t.is_ABC AS isABC,
			getBaseDateNameByCode('IS_ABC',t.is_ABC,1) AS "isABCName",
			t.create_by AS createBy,
			 (select name from xxm_user_t u where u.user_id=t.create_by) AS createByName,
			t.create_date AS createDate,
			t.last_update_by AS lastUpdateBy,
			t.last_update_date AS lastUpdateDate,
			t.status AS status,
			t.customer_level AS customerLevel,
			
			t.appli_health AS appliHealth,
			getBaseDateNameByCode('APPLI_HEALTH',t.appli_health,1) AS "appliHealthName",
			t.appli_residence AS appliResidence,
			getBaseDateNameByCode('APPLI_RESIDENCE',t.appli_residence,1) AS "appliResidenceName",
			t.appli_work AS appliWork,
			getBaseDateNameByCode('APPLIWORK',t.appli_work,1) AS "appliWorkName",
			t.income_source AS incomeSource,
			getBaseDateNameByCode('INCOME_SOURCE',t.income_source,1) AS "incomeSourceName",
			t.piscale AS piscale,
			t.month_economy AS monthEconomy,
			t.house_stat AS houseStat,
			getBaseDateNameByCode('HOUSE_STAT',t.house_stat,1) AS "houseStatName",
			t.house_source AS houseSource,
			getBaseDateNameByCode('HOUSE_SOURCE',t.house_source,1) AS "houseSourceName",
			t.house_type AS houseType,
			getBaseDateNameByCode('HOUSE_TYPE',t.house_type,1) AS "houseTypeName",
			t.family_sts AS familySts,
			getBaseDateNameByCode('FAMILY_STS',t.family_sts,1) AS "familyStsName",
			t.family_year AS familyYear,
			t.repay_rec AS repayRec,
			getBaseDateNameByCode('REPAY_REC',t.repay_rec,1) AS "repayRecName",
			t.pub_rec AS pubRec,
			getBaseDateNameByCode('PUB_REC',t.pub_rec,1) AS "pubRecName",
			t.oth_rec AS othRec,
			getBaseDateNameByCode('OTH_REC',t.oth_rec,1) AS "othRecName",
			t.remark AS remark,
			t.sum_score AS sumScore,
			t.credit_man_code AS creditManCode,
			t.credit_flag AS creditFlag,
			t.company_zip AS companyZip,
			t.company_tel_code AS companyTelCode,
			t.company_tel AS companyTel,
			t.apply_purpose AS applyPurpose,
			t.monthly_wages AS monthlyWages,
			t.moth_ep AS mothEp,
			t.unit_type AS unitType,
			getBaseDateNameByCode('UNIT_TYPE',t.unit_type,1) AS "unitTypeName",
			t.employment AS employment,
			t.department AS department,
			t.year_income AS yearIncome,
			t.appliId_email AS appliIdEmail,
			t.appli_post AS appliPost,
			t.family_telcode AS familyTelcode,
			t.payment_acctno AS paymentAcctno,
			t.idvalid_start AS idvalidStart,
			t.idvalid_end AS idvalidEnd,
			t.iss_ctry AS issCtry,
			t.appli_age AS appliAge,
			t.positions AS positions,
			getBaseDateNameByCode('APPLIDUTY',t.positions,1) AS "positionsName",
			t.lock_man AS lockMan
		FROM
		xxm_base_customer_t t
		LEFT JOIN xxm_customer_t b ON b.base_Customer_Id = t.base_Customer_Id
		WHERE 1=1
	</sql>
	
	<sql id="query_Customer_sql">
		 SELECT
		 	t.customer_Id AS customerId,
			t.base_Customer_Id AS baseCustomerId,
			t.base_Customer_Name AS baseCustomerName,
			t.base_Customer_Sex AS baseCustomerSex,
			getBaseDateNameByCode('BAQSNG_SEX',t.base_Customer_Sex,1) AS "baseCustomerSexName",
			t.cert_Type AS certType,
			getBaseDateNameByCode('BAQSNG_PAPER_TYPE',t.cert_Type,1) AS "certTypeName",
			t.cert_No AS certNo,
			t.issued_Date AS issuedDate,
			t.expiration_Date AS expirationDate,
			t.tax_Type AS taxType,
			t.marriage_Status AS marriageStatus,
			getBaseDateNameByCode('MARITAL_STATUS',t.marriage_Status,1) AS "marriageStatusName",
			t.spouse_Name AS spouseName,
			t.spouse_Id_Type AS spouseIdType,
			getBaseDateNameByCode('BAQSNG_PAPER_TYPE',t.spouse_Id_Type,1) AS "spouseIdTypeName",
			t.spouse_Id_No AS spouseIdNo,
			t.spouse_Mobile AS spouseMobile,
			t.education_Type AS educationType,
			getBaseDateNameByCode('EDUCATION_TYPE',t.education_Type,1) AS "educationTypeName",
			t.live_Addr AS liveAddr,
			t.live_City AS liveCity,
			t.company_Name AS companyName,
			t.position AS position,
			t.service_Year AS serviceYear,
			t.income AS income,
			t.company_Addr AS companyAddr,
			t.unit_Kind AS unitKind,
			t.mobile_No AS mobileNo,
			t.acc_No AS accNo,
			t.bank_Flag AS bankFlag,
			t.open_Bank_Name AS openBankName,
			getBaseDateNameByCode('LOAN_BANK',t.open_Bank_Name,1) AS "openBankBaseName",
			t.open_Bank_No AS openBankNo,
			t.cert_Image_File AS certImageFile,
			t.create_by AS createBy,
			t.create_date AS createDate,
			t.last_update_by AS lastUpdateBy,
			t.last_update_date AS lastUpdateDate,
			t.identification AS identification,
			t.census_register_place AS censusRegisterPlace,
			t.birth_date AS birthDate,
			t.fixed_line AS fixedLine,
			t.account_name AS accountName,
			t.deductions_object_type AS deductionsObjectType,
			getBaseDateNameByCode('BANK_FLAG',t.deductions_object_type,1) AS "deductionsObjectTypeName",
			t.is_ABC AS isABC,
			getBaseDateNameByCode('IS_ABC',t.is_ABC,1) AS "isABCName",
			t.drawee_bank_name AS draweeBankName,
			t.drawee_bank_account AS draweeBankAccount,
			t.drawee_bank AS draweeBank,
			t.large_line_No AS largeLineNo,
			t.spouse_position AS spousePosition,
			t.spouse_phone2 AS spousePhone2,
			
			t.appli_health AS appliHealth,
			getBaseDateNameByCode('APPLI_HEALTH',t.appli_health,1) AS "appliHealthName",
			t.appli_residence AS appliResidence,
			t.appli_work AS appliWork,
			getBaseDateNameByCode('APPLIWORK',t.appli_work,1) AS "appliWorkName",
			t.income_source AS incomeSource,
			getBaseDateNameByCode('INCOME_SOURCE',t.income_source,1) AS "incomeSourceName",
			t.piscale AS piscale,
			t.month_economy AS monthEconomy,
			t.house_stat AS houseStat,
			getBaseDateNameByCode('HOUSE_STAT',t.house_stat,1) AS "houseStatName",
			t.house_source AS houseSource,
			getBaseDateNameByCode('HOUSE_SOURCE',t.house_source,1) AS "houseSourceName",
			t.house_type AS houseType,
			getBaseDateNameByCode('HOUSE_TYPE',t.house_type,1) AS "houseTypeName",
			t.family_sts AS familySts,
			getBaseDateNameByCode('FAMILY_STS',t.family_sts,1) AS "familyStsName",
			t.family_year AS familyYear,
			t.repay_rec AS repayRec,
			getBaseDateNameByCode('REPAY_REC',t.repay_rec,1) AS "repayRecName",
			t.pub_rec AS pubRec,
			getBaseDateNameByCode('PUB_REC',t.pub_rec,1) AS "pubRecName",
			t.oth_rec AS othRec,
			getBaseDateNameByCode('OTH_REC',t.oth_rec,1) AS "othRecName",
			t.remark AS remark,
			t.sum_score AS sumScore,
			t.credit_man_code AS creditManCode,
			t.credit_flag AS creditFlag,
			t.company_zip AS companyZip,
			t.company_tel_code AS companyTelCode,
			t.company_tel AS companyTel,
			t.apply_purpose AS applyPurpose,
			t.monthly_wages AS monthlyWages,
			t.moth_ep AS mothEp,
			t.unit_type AS unitType,
			getBaseDateNameByCode('UNIT_TYPE',t.unit_type,1) AS "unitTypeName",
			t.employment AS employment,
			t.department AS department,
			t.year_income AS yearIncome,
			t.appliId_email AS appliIdEmail,
			t.appli_post AS appliPost,
			t.family_telcode AS familyTelcode,
			t.payment_acctno AS paymentAcctno,
			t.idvalid_start AS idvalidStart,
			t.idvalid_end AS idvalidEnd,
			t.iss_ctry AS issCtry,
			t.appli_age AS appliAge,
			t.positions AS positions,
			getBaseDateNameByCode('APPLIDUTY',t.positions,1) AS "positionsName"
		FROM
		xxm_customer_t t
		WHERE 1=1
	</sql>
	
	<sql id="BaseCustomer_select_condition">
		 <if test="baseCustomerId != null and baseCustomerId !=''">
	    	AND t.base_Customer_Id= #{baseCustomerId,jdbcType=VARCHAR}
	  	 </if>
	  	 <if test="customerId != null and customerId !=''">
	    	AND t.customer_Id= #{customerId,jdbcType=VARCHAR}
	  	 </if>
	  	 <if test="baseCustomerName != null and baseCustomerName !=''">
	    	AND t.base_Customer_Name= #{baseCustomerName,jdbcType=VARCHAR}
	  	 </if>
	</sql>
	
	<sql id="select_condition">
	  <if test="baseCustomerName != null and baseCustomerName != ''">
	   AND t.base_Customer_Name like concat('%',#{baseCustomerName,jdbcType=VARCHAR},'%')
	  </if>
	</sql>
	
	<!-- 添加基础客户信息 -->
	<insert id="addBaseCustomer" parameterType="com.xxm.it.business.vo.BaseCustomerVO" useGeneratedKeys="true" keyProperty="baseCustomerId">
		 INSERT INTO xxm_base_customer_t (
			base_Customer_Name,
			base_Customer_Sex,
			cert_Type,
			cert_No,
			issued_Date,
			expiration_Date,
			tax_Type,
			marriage_Status,
			spouse_Name,
			spouse_Id_Type,
			spouse_Id_No,
			spouse_Mobile,
			education_Type,
			live_Addr,
			live_City,
			company_Name,
			position,
			service_Year,
			income,
			company_Addr,
			unit_Kind,
			mobile_No,
			acc_No,
			bank_Flag,
			open_Bank_Name,
			open_Bank_No,
			cert_Image_File,
			
			census_register_place,
			birth_date,
			fixed_line,
			account_name,
			deductions_object_type,
			is_ABC,
			drawee_bank_name,
			drawee_bank_account,
			drawee_bank,
			Large_line_No,
			spouse_position,
			spouse_phone2,
			identification,
			status,
			customer_level,
			appli_health,
			appli_residence,
			appli_work,
			income_source,
			piscale,
			month_economy,
			house_stat,
			house_source,
			house_type,
			family_sts,
			family_year,
			repay_rec,
			pub_rec,
			oth_rec,
			remark,
			sum_score,
			credit_man_code,
			credit_flag,
			company_zip,
			company_tel_code,
			company_tel,
			apply_purpose,
			monthly_wages,
			moth_ep,
			unit_type,
			employment,
			department,
			year_income,
			appliId_email,
			appli_post,
			family_telcode,
			payment_acctno,
			idvalid_start,
			idvalid_end,
			iss_ctry,
			appli_age,
			positions,
			lock_man,
			create_by,
			create_date,
			last_update_by,
			last_update_date
		)
		VALUES
			(
				#{baseCustomerName,jdbcType=VARCHAR},
				#{baseCustomerSex,jdbcType=VARCHAR},
				#{certType,jdbcType=VARCHAR},
				#{certNo,jdbcType=VARCHAR},
				#{issuedDate,jdbcType=VARCHAR},
				#{expirationDate,jdbcType=VARCHAR},
				#{taxType,jdbcType=VARCHAR},
				#{marriageStatus,jdbcType=VARCHAR},
				#{spouseName,jdbcType=VARCHAR},
				#{spouseIdType,jdbcType=VARCHAR},
				#{spouseIdNo,jdbcType=VARCHAR},
				#{spouseMobile,jdbcType=VARCHAR},
				#{educationType,jdbcType=VARCHAR},
				#{liveAddr,jdbcType=VARCHAR},
				#{liveCity,jdbcType=VARCHAR},
				#{companyName,jdbcType=VARCHAR},
				#{position,jdbcType=VARCHAR},
				#{serviceYear,jdbcType=VARCHAR},
				#{income,jdbcType=VARCHAR},
				#{companyAddr,jdbcType=VARCHAR},
				#{unitKind,jdbcType=VARCHAR},
				#{mobileNo,jdbcType=VARCHAR},
				#{accNo,jdbcType=VARCHAR},
				#{bankFlag,jdbcType=VARCHAR},
				#{openBankName,jdbcType=VARCHAR},
				#{openBankNo,jdbcType=VARCHAR},
				#{certImageFile,jdbcType=VARCHAR},
				
				#{censusRegisterPlace,jdbcType=VARCHAR},
				#{birthDate,jdbcType=VARCHAR},
				#{fixedLine,jdbcType=VARCHAR},
				#{accountName,jdbcType=VARCHAR},
				#{deductionsObjectType,jdbcType=VARCHAR},
				#{isABC,jdbcType=VARCHAR},
				#{draweeBankName,jdbcType=VARCHAR},
				#{draweeBankAccount,jdbcType=VARCHAR},
				#{draweeBank,jdbcType=VARCHAR},
				#{largeLineNo,jdbcType=VARCHAR},
				#{spousePosition,jdbcType=VARCHAR},
				#{spousePhone2,jdbcType=VARCHAR},
				#{identification,jdbcType=VARCHAR},
				#{status,jdbcType=VARCHAR},
				#{customerLevel,jdbcType=VARCHAR},
				#{appliHealth,jdbcType=VARCHAR},
				#{appliResidence,jdbcType=VARCHAR},
				#{appliWork,jdbcType=VARCHAR},
				#{incomeSource,jdbcType=VARCHAR},
				#{piscale,jdbcType=VARCHAR},
				#{monthEconomy,jdbcType=VARCHAR},
				#{houseStat,jdbcType=VARCHAR},
				#{houseSource,jdbcType=VARCHAR},
				#{houseType,jdbcType=VARCHAR},
				#{familySts,jdbcType=VARCHAR},
				#{familyYear,jdbcType=VARCHAR},
				#{repayRec,jdbcType=VARCHAR},
				#{pubRec,jdbcType=VARCHAR},
				#{othRec,jdbcType=VARCHAR},
				#{remark,jdbcType=VARCHAR},
				#{sumScore,jdbcType=VARCHAR},
				#{creditManCode,jdbcType=VARCHAR},
				#{creditFlag,jdbcType=VARCHAR},
				#{companyZip,jdbcType=VARCHAR},
				#{companyTelCode,jdbcType=VARCHAR},
				#{companyTel,jdbcType=VARCHAR},
				#{applyPurpose,jdbcType=VARCHAR},
				#{monthlyWages,jdbcType=VARCHAR},
				#{mothEp,jdbcType=VARCHAR},
				#{unitType,jdbcType=VARCHAR},
				#{employment,jdbcType=VARCHAR},
				#{department,jdbcType=VARCHAR},
				#{yearIncome,jdbcType=VARCHAR},
				#{appliIdEmail,jdbcType=VARCHAR},
				#{appliPost,jdbcType=VARCHAR},
				#{familyTelcode,jdbcType=VARCHAR},
				#{paymentAcctno,jdbcType=VARCHAR},
				#{idvalidStart,jdbcType=VARCHAR},
				#{idvalidEnd,jdbcType=VARCHAR},
				#{issCtry,jdbcType=VARCHAR},
				#{appliAge,jdbcType=VARCHAR},
				#{positions,jdbcType=VARCHAR},
				#{lockMan,jdbcType=VARCHAR},
				#{createBy,jdbcType=VARCHAR},
				sysdate(),
				#{lastUpdateBy,jdbcType=VARCHAR},
				sysdate()
			)
	</insert>
	<insert id="addBaseCustomerType" parameterType="com.xxm.it.business.vo.BaseCustomerVO" useGeneratedKeys="true" keyProperty="baseCustomerId">
		INSERT INTO xxm_base_customer_t (
				base_Customer_Name,
				base_Customer_Sex,
				cert_Type,
				cert_No,
				issued_Date,
				expiration_Date,
				tax_Type,
				marriage_Status,
				spouse_Name,
				spouse_Id_Type,
				spouse_Id_No,
				spouse_Mobile,
				education_Type,
				live_Addr,
				live_City,
				company_Name,
				position,
				service_Year,
				income,
				company_Addr,
				unit_Kind,
				mobile_No,
				acc_No,
				bank_Flag,
				open_Bank_Name,
				open_Bank_No,
				cert_Image_File,
				create_by,
				create_date,
				last_update_by,
				last_update_date,
				census_register_place,
				birth_date,
				fixed_line,
				account_name,
				deductions_object_type,
				is_ABC,
				drawee_bank_name,
				drawee_bank_account,
				drawee_bank,
				Large_line_No,
				spouse_position,
				spouse_phone2,
				identification,
				status,
				customer_level,
				appli_health,
				appli_residence,
				appli_work,
				income_source,
				piscale,
				month_economy,
				house_stat,
				house_source,
				house_type,
				family_sts,
				family_year,
				repay_rec,
				pub_rec,
				oth_rec,
				remark,
				sum_score,
				credit_man_code,
				credit_flag,
				company_zip,
				company_tel_code,
				company_tel,
				apply_purpose,
				monthly_wages,
				moth_ep,
				unit_type,
				employment,
				department,
				year_income,
				appliId_email,
				appli_post,
				family_telcode,
				payment_acctno,
				idvalid_start,
				idvalid_end,
				iss_ctry,
				appli_age,
				positions,
				lock_man
			)
			VALUES
				(
					#{baseCustomerName,jdbcType=VARCHAR},
					#{baseCustomerSex,jdbcType=VARCHAR},
					#{certType,jdbcType=VARCHAR},
					#{certNo,jdbcType=VARCHAR},
					#{issuedDate,jdbcType=VARCHAR},
					#{expirationDate,jdbcType=VARCHAR},
					#{taxType,jdbcType=VARCHAR},
					#{marriageStatus,jdbcType=VARCHAR},
					#{spouseName,jdbcType=VARCHAR},
					#{spouseIdType,jdbcType=VARCHAR},
					#{spouseIdNo,jdbcType=VARCHAR},
					#{spouseMobile,jdbcType=VARCHAR},
					#{educationType,jdbcType=VARCHAR},
					#{liveAddr,jdbcType=VARCHAR},
					#{liveCity,jdbcType=VARCHAR},
					#{companyName,jdbcType=VARCHAR},
					#{position,jdbcType=VARCHAR},
					#{serviceYear,jdbcType=VARCHAR},
					#{income,jdbcType=VARCHAR},
					#{companyAddr,jdbcType=VARCHAR},
					#{unitKind,jdbcType=VARCHAR},
					#{mobileNo,jdbcType=VARCHAR},
					#{accNo,jdbcType=VARCHAR},
					#{bankFlag,jdbcType=VARCHAR},
					#{openBankName,jdbcType=VARCHAR},
					#{openBankNo,jdbcType=VARCHAR},
					#{certImageFile,jdbcType=VARCHAR},
					#{createBy,jdbcType=VARCHAR},
					sysdate(),
					#{lastUpdateBy,jdbcType=VARCHAR},
					sysdate(),
					#{censusRegisterPlace,jdbcType=VARCHAR},
					#{birthDate,jdbcType=VARCHAR},
					#{fixedLine,jdbcType=VARCHAR},
					#{accountName,jdbcType=VARCHAR},
					#{deductionsObjectType,jdbcType=VARCHAR},
					#{isABC,jdbcType=VARCHAR},
					#{draweeBankName,jdbcType=VARCHAR},
					#{draweeBankAccount,jdbcType=VARCHAR},
					#{draweeBank,jdbcType=VARCHAR},
					#{LargeLineNo,jdbcType=VARCHAR},
					#{spousePosition,jdbcType=VARCHAR},
					#{spousePhone2,jdbcType=VARCHAR},
					#{identification,jdbcType=VARCHAR},
					#{status,jdbcType=VARCHAR},
					#{customerLevel,jdbcType=VARCHAR},
					#{appliHealth,jdbcType=VARCHAR},
					#{appliResidence,jdbcType=VARCHAR},
					#{appliWork,jdbcType=VARCHAR},
					#{incomeSource,jdbcType=VARCHAR},
					#{piscale,jdbcType=VARCHAR},
					#{monthEconomy,jdbcType=VARCHAR},
					#{houseStat,jdbcType=VARCHAR},
					#{houseSource,jdbcType=VARCHAR},
					#{houseType,jdbcType=VARCHAR},
					#{familySts,jdbcType=VARCHAR},
					#{familyYear,jdbcType=VARCHAR},
					#{repayRec,jdbcType=VARCHAR},
					#{pubRec,jdbcType=VARCHAR},
					#{othRec,jdbcType=VARCHAR},
					#{remark,jdbcType=VARCHAR},
					#{sumScore,jdbcType=VARCHAR},
					#{creditManCode,jdbcType=VARCHAR},
					#{creditFlag,jdbcType=VARCHAR},
					#{companyZip,jdbcType=VARCHAR},
					#{companyTelCode,jdbcType=VARCHAR},
					#{companyTel,jdbcType=VARCHAR},
					#{applyPurpose,jdbcType=VARCHAR},
					#{monthlyWages,jdbcType=VARCHAR},
					#{mothEp,jdbcType=VARCHAR},
					#{unitType,jdbcType=VARCHAR},
					#{employment,jdbcType=VARCHAR},
					#{department,jdbcType=VARCHAR},
					#{yearIncome,jdbcType=VARCHAR},
					#{appliIdEmail,jdbcType=VARCHAR},
					#{appliPost,jdbcType=VARCHAR},
					#{familyTelcode,jdbcType=VARCHAR},
					#{paymentAcctno,jdbcType=VARCHAR},
					#{idvalidStart,jdbcType=VARCHAR},
					#{idvalidEnd,jdbcType=VARCHAR},
					#{issCtry,jdbcType=VARCHAR},
					#{appliAge,jdbcType=VARCHAR},
					#{positions,jdbcType=VARCHAR},
					#{lockMan,jdbcType=VARCHAR}
				)
	</insert>
	
	<!-- 添加客户信息 -->
	<insert id="addCustomer" parameterType="com.xxm.it.business.vo.BaseCustomerVO" useGeneratedKeys="true" keyProperty="customerId">
		 INSERT INTO xxm_customer_t (
			base_Customer_Id,
			base_Customer_Name,
			base_Customer_Sex,
			cert_Type,
			cert_No,
			issued_Date,
			expiration_Date,
			tax_Type,
			marriage_Status,
			spouse_Name,
			spouse_Id_Type,
			spouse_Id_No,
			spouse_Mobile,
			education_Type,
			live_Addr,
			live_City,
			company_Name,
			position,
			service_Year,
			income,
			company_Addr,
			unit_Kind,
			mobile_No,
			acc_No,
			bank_Flag,
			open_Bank_Name,
			open_Bank_No,
			cert_Image_File,
			create_by,
			create_date,
			last_update_by,
			last_update_date,
			identification,
			census_register_place,
			birth_date,
			fixed_line,
			account_name,
			deductions_object_type,
			is_ABC,
			drawee_bank_name,
			drawee_bank_account,
			drawee_bank,
			large_line_No,
			spouse_position,
			spouse_phone2,
			appli_health,
			appli_residence,
			appli_work,
			income_source,
			piscale,
			month_economy,
			house_stat,
			house_source,
			house_type,
			family_sts,
			family_year,
			repay_rec,
			pub_rec,
			oth_rec,
			remark,
			sum_score,
			credit_man_code,
			credit_flag,
			company_zip,
			company_tel_code,
			company_tel,
			apply_purpose,
			monthly_wages,
			moth_ep,
			unit_type,
			employment,
			department,
			year_income,
			appliId_email,
			appli_post,
			family_telcode,
			payment_acctno,
			idvalid_start,
			idvalid_end,
			iss_ctry,
			appli_age,
			positions
		)
		VALUES
			(
				#{baseCustomerId,jdbcType=VARCHAR},
				#{baseCustomerName,jdbcType=VARCHAR},
				#{baseCustomerSex,jdbcType=VARCHAR},
				#{certType,jdbcType=VARCHAR},
				#{certNo,jdbcType=VARCHAR},
				#{issuedDate,jdbcType=VARCHAR},
				#{expirationDate,jdbcType=VARCHAR},
				#{taxType,jdbcType=VARCHAR},
				#{marriageStatus,jdbcType=VARCHAR},
				#{spouseName,jdbcType=VARCHAR},
				#{spouseIdType,jdbcType=VARCHAR},
				#{spouseIdNo,jdbcType=VARCHAR},
				#{spouseMobile,jdbcType=VARCHAR},
				#{educationType,jdbcType=VARCHAR},
				#{liveAddr,jdbcType=VARCHAR},
				#{liveCity,jdbcType=VARCHAR},
				#{companyName,jdbcType=VARCHAR},
				#{position,jdbcType=VARCHAR},
				#{serviceYear,jdbcType=VARCHAR},
				#{income,jdbcType=VARCHAR},
				#{companyAddr,jdbcType=VARCHAR},
				#{unitKind,jdbcType=VARCHAR},
				#{mobileNo,jdbcType=VARCHAR},
				#{accNo,jdbcType=VARCHAR},
				#{bankFlag,jdbcType=VARCHAR},
				#{openBankName,jdbcType=VARCHAR},
				#{openBankNo,jdbcType=VARCHAR},
				#{certImageFile,jdbcType=VARCHAR},
				#{createBy,jdbcType=VARCHAR},
				sysdate(),
				#{lastUpdateBy,jdbcType=VARCHAR},
				sysdate(),
				#{identification,jdbcType=VARCHAR},
				#{censusRegisterPlace,jdbcType=VARCHAR},
				#{birthDate,jdbcType=VARCHAR},
				#{fixedLine,jdbcType=VARCHAR},
				#{accountName,jdbcType=VARCHAR},
				#{deductionsObjectType,jdbcType=VARCHAR},
				#{isABC,jdbcType=VARCHAR},
				#{draweeBankName,jdbcType=VARCHAR},
				#{draweeBankAccount,jdbcType=VARCHAR},
				#{draweeBank,jdbcType=VARCHAR},
				#{largeLineNo,jdbcType=VARCHAR},
				#{spousePosition,jdbcType=VARCHAR},
				#{spousePhone2,jdbcType=VARCHAR},
				#{appliHealth,jdbcType=VARCHAR},
				#{appliResidence,jdbcType=VARCHAR},
				#{appliWork,jdbcType=VARCHAR},
				#{incomeSource,jdbcType=VARCHAR},
				#{piscale,jdbcType=VARCHAR},
				#{monthEconomy,jdbcType=VARCHAR},
				#{houseStat,jdbcType=VARCHAR},
				#{houseSource,jdbcType=VARCHAR},
				#{houseType,jdbcType=VARCHAR},
				#{familySts,jdbcType=VARCHAR},
				#{familyYear,jdbcType=VARCHAR},
				#{repayRec,jdbcType=VARCHAR},
				#{pubRec,jdbcType=VARCHAR},
				#{othRec,jdbcType=VARCHAR},
				#{remark,jdbcType=VARCHAR},
				#{sumScore,jdbcType=VARCHAR},
				#{creditManCode,jdbcType=VARCHAR},
				#{creditFlag,jdbcType=VARCHAR},
				#{companyZip,jdbcType=VARCHAR},
				#{companyTelCode,jdbcType=VARCHAR},
				#{companyTel,jdbcType=VARCHAR},
				#{applyPurpose,jdbcType=VARCHAR},
				#{monthlyWages,jdbcType=VARCHAR},
				#{mothEp,jdbcType=VARCHAR},
				#{unitType,jdbcType=VARCHAR},
				#{employment,jdbcType=VARCHAR},
				#{department,jdbcType=VARCHAR},
				#{yearIncome,jdbcType=VARCHAR},
				#{appliIdEmail,jdbcType=VARCHAR},
				#{appliPost,jdbcType=VARCHAR},
				#{familyTelcode,jdbcType=VARCHAR},
				#{paymentAcctno,jdbcType=VARCHAR},
				#{idvalidStart,jdbcType=VARCHAR},
				#{idvalidEnd,jdbcType=VARCHAR},
				#{issCtry,jdbcType=VARCHAR},
				#{appliAge,jdbcType=VARCHAR},
				#{positions,jdbcType=VARCHAR}
			)
	</insert>
	
	<!-- 查询基础客户信息-->
	<select id="findBaseCustomer" resultType="com.xxm.it.business.vo.BaseCustomerVO" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
		 <include refid="query_baseCustomer_sql"></include>
	  	 <include refid="BaseCustomer_select_condition"></include>
	</select>
	
	<!-- 查询基础客户信息(List)-->
	<select id="findBaseCustomers" resultType="com.xxm.it.business.vo.BaseCustomerVO" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
		 <include refid="query_baseCustomer_sql"></include>
		 <include refid="BaseCustomer_select_condition"></include>
	</select>
	
	<!-- 查询客户信息-->
	<select id="findCustomer" resultType="com.xxm.it.business.vo.BaseCustomerVO" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
		 <include refid="query_Customer_sql"></include>
	  	 AND t.customer_Id=#{customerId,jdbcType=VARCHAR}
	</select>
	
	
	
	
	
	<!-- 查询潜在客户类型基础信息列表 -->
	<select id="findBaseCustomerList" resultType="com.xxm.it.business.vo.BaseCustomerVO" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
	  <include refid="query_baseCustomer_sql"></include>
	  <include refid="select_condition"></include>
	    AND t.status=#{status,jdbcType=VARCHAR}
	    AND t.customer_level = #{customerLevel,jdbcType=VARCHAR}  
		order by t.create_date desc
		limit #{offset,jdbcType=VARCHAR},#{limit,jdbcType=VARCHAR}
	</select>
	<!-- 查询客户基础信息总数 -->
	<select id="findBaseCustomerListCount" resultType="java.lang.Integer" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
	    SELECT count(base_Customer_Id) FROM xxm_base_customer_t t WHERE 1=1 
	    AND t.status=#{status,jdbcType=VARCHAR}
	    AND t.customer_level = #{customerLevel,jdbcType=VARCHAR} 
	    <include refid="select_condition"></include>
	</select>
	<delete id="deleteBaseCustomer" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
	    UPDATE xxm_base_customer_t SET 
			status= #{status, jdbcType=VARCHAR}
		WHERE base_Customer_Id in 
		<foreach collection="customerIds" item="item" index="index" separator="," open="(" close=")">  
			#{item}
		</foreach> 
	</delete>
	
	<update id="updateBaseCustomer" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
		UPDATE xxm_base_customer_t SET 
			base_Customer_Name = #{baseCustomerName,jdbcType=VARCHAR},
			base_Customer_Sex = #{baseCustomerSex,jdbcType=VARCHAR},
			cert_Type = #{certType,jdbcType=VARCHAR},
			cert_No = #{certNo,jdbcType=VARCHAR},
			issued_Date = #{issuedDate,jdbcType=VARCHAR},
			expiration_Date = #{expirationDate,jdbcType=VARCHAR},
			tax_Type = #{taxType,jdbcType=VARCHAR},
			marriage_Status = #{marriageStatus,jdbcType=VARCHAR},
			spouse_Name = #{spouseName,jdbcType=VARCHAR},
			spouse_Id_Type = #{spouseIdType,jdbcType=VARCHAR},
			spouse_Id_No = #{spouseIdNo,jdbcType=VARCHAR},
			spouse_Mobile = #{spouseMobile,jdbcType=VARCHAR},
			education_Type = #{educationType,jdbcType=VARCHAR},
			live_Addr = #{liveAddr,jdbcType=VARCHAR},
			live_City = #{liveCity,jdbcType=VARCHAR},
			company_Name = #{companyName,jdbcType=VARCHAR},
			position = #{position,jdbcType=VARCHAR},
			service_Year = #{serviceYear,jdbcType=VARCHAR},
			income = #{income,jdbcType=VARCHAR},
			company_Addr = #{companyAddr,jdbcType=VARCHAR},
			unit_Kind = #{unitKind,jdbcType=VARCHAR},
			mobile_No = #{mobileNo,jdbcType=VARCHAR},
			acc_No = #{accNo,jdbcType=VARCHAR},
			bank_Flag = #{bankFlag,jdbcType=VARCHAR},
			open_Bank_Name = #{openBankName,jdbcType=VARCHAR},
			open_Bank_No = #{openBankNo,jdbcType=VARCHAR},
			cert_Image_File = #{certImageFile,jdbcType=VARCHAR},
			create_by = #{createBy,jdbcType=VARCHAR},
			create_date = #{createDate,jdbcType=VARCHAR},
			last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
			last_update_date = #{lastUpdateDate,jdbcType=VARCHAR},
			census_register_place = #{censusRegisterPlace,jdbcType=VARCHAR},
			birth_date = #{birthDate,jdbcType=VARCHAR},
			fixed_line = #{fixedLine,jdbcType=VARCHAR},
			account_name = #{accountName,jdbcType=VARCHAR},
			deductions_object_type = #{deductionsObjectType,jdbcType=VARCHAR},
			is_ABC = #{isABC,jdbcType=VARCHAR},
			drawee_bank_name = #{draweeBankName,jdbcType=VARCHAR},
			drawee_bank_account = #{draweeBankAccount,jdbcType=VARCHAR},
			drawee_bank = #{draweeBank,jdbcType=VARCHAR},
			Large_line_No = #{LargeLineNo,jdbcType=VARCHAR},
			spouse_position = #{spousePosition,jdbcType=VARCHAR},
			spouse_phone2 = #{spousePhone2,jdbcType=VARCHAR},
			identification = #{identification,jdbcType=VARCHAR},
			status = #{status,jdbcType=VARCHAR},
			customer_level = #{customerLevel,jdbcType=VARCHAR},
			appli_health = #{appliHealth,jdbcType=VARCHAR},
			appli_residence = #{appliResidence,jdbcType=VARCHAR},
			appli_work = #{appliWork,jdbcType=VARCHAR},
			income_source = #{incomeSource,jdbcType=VARCHAR},
			piscale = #{piscale,jdbcType=VARCHAR},
			month_economy = #{monthEconomy,jdbcType=VARCHAR},
			house_stat = #{houseStat,jdbcType=VARCHAR},
			house_source = #{houseSource,jdbcType=VARCHAR},
			house_type = #{houseType,jdbcType=VARCHAR},
			family_sts = #{familySts,jdbcType=VARCHAR},
			family_year = #{familyYear,jdbcType=VARCHAR},
			repay_rec = #{repayRec,jdbcType=VARCHAR},
			pub_rec = #{pubRec,jdbcType=VARCHAR},
			oth_rec = #{othRec,jdbcType=VARCHAR},
			remark = #{remark,jdbcType=VARCHAR},
			sum_score = #{sumScore,jdbcType=VARCHAR},
			credit_man_code = #{creditManCode,jdbcType=VARCHAR},
			credit_flag = #{creditFlag,jdbcType=VARCHAR},
			company_zip = #{companyZip,jdbcType=VARCHAR},
			company_tel_code = #{companyTelCode,jdbcType=VARCHAR},
			company_tel = #{companyTel,jdbcType=VARCHAR},
			apply_purpose = #{applyPurpose,jdbcType=VARCHAR},
			monthly_wages = #{monthlyWages,jdbcType=VARCHAR},
			moth_ep = #{mothEp,jdbcType=VARCHAR},
			unit_type = #{unitType,jdbcType=VARCHAR},
			employment = #{employment,jdbcType=VARCHAR},
			department = #{department,jdbcType=VARCHAR},
			year_income = #{yearIncome,jdbcType=VARCHAR},
			appliId_email = #{appliIdEmail,jdbcType=VARCHAR},
			appli_post = #{appliPost,jdbcType=VARCHAR},
			family_telcode = #{familyTelcode,jdbcType=VARCHAR},
			payment_acctno = #{paymentAcctno,jdbcType=VARCHAR},
			idvalid_start = #{idvalidStart,jdbcType=VARCHAR},
			idvalid_end = #{idvalidEnd,jdbcType=VARCHAR},
			iss_ctry = #{issCtry,jdbcType=VARCHAR},
			appli_age = #{appliAge,jdbcType=VARCHAR},
			positions = #{positions,jdbcType=VARCHAR},
			lock_man = #{lockMan,jdbcType=VARCHAR}
		WHERE
			base_Customer_Id = #{baseCustomerId,jdbcType=VARCHAR}
	</update>
	
	<update id="updateCustomer" parameterType="com.xxm.it.business.vo.BaseCustomerVO">
		UPDATE xxm_customer_t SET 
			base_Customer_Id = #{baseCustomerId,jdbcType=VARCHAR},
			base_Customer_Name = #{baseCustomerName,jdbcType=VARCHAR},
			base_Customer_Sex = #{baseCustomerSex,jdbcType=VARCHAR},
			cert_Type = #{certType,jdbcType=VARCHAR},
			cert_No = #{certNo,jdbcType=VARCHAR},
			<if test="issuedDate != null and issuedDate !=''">
	    		issued_Date = #{issuedDate,jdbcType=VARCHAR},
	  	 	</if>
	  	 	<if test="expirationDate != null and expirationDate !=''">
	    		expiration_Date = #{expirationDate,jdbcType=VARCHAR},
	  	 	</if>
			tax_Type = #{taxType,jdbcType=VARCHAR},
			marriage_Status = #{marriageStatus,jdbcType=VARCHAR},
			spouse_Name = #{spouseName,jdbcType=VARCHAR},
			spouse_Id_Type = #{spouseIdType,jdbcType=VARCHAR},
			spouse_Id_No = #{spouseIdNo,jdbcType=VARCHAR},
			spouse_Mobile = #{spouseMobile,jdbcType=VARCHAR},
			education_Type = #{educationType,jdbcType=VARCHAR},
			live_Addr = #{liveAddr,jdbcType=VARCHAR},
			live_City = #{liveCity,jdbcType=VARCHAR},
			company_Name = #{companyName,jdbcType=VARCHAR},
			position = #{position,jdbcType=VARCHAR},
			service_Year = #{serviceYear,jdbcType=VARCHAR},
			income = #{income,jdbcType=VARCHAR},
			company_Addr = #{companyAddr,jdbcType=VARCHAR},
			unit_Kind = #{unitKind,jdbcType=VARCHAR},
			mobile_No = #{mobileNo,jdbcType=VARCHAR},
			acc_No = #{accNo,jdbcType=VARCHAR},
			bank_Flag = #{bankFlag,jdbcType=VARCHAR},
			open_Bank_Name = #{openBankName,jdbcType=VARCHAR},
			open_Bank_No = #{openBankNo,jdbcType=VARCHAR},
			cert_Image_File = #{certImageFile,jdbcType=VARCHAR},
			identification = #{identification,jdbcType=VARCHAR},
			census_register_place = #{censusRegisterPlace,jdbcType=VARCHAR},
			<if test="birthDate != null and birthDate !=''">
	    		birth_date = #{birthDate,jdbcType=VARCHAR},
	  	 	</if>
			fixed_line = #{fixedLine,jdbcType=VARCHAR},
			account_name = #{accountName,jdbcType=VARCHAR},
			deductions_object_type = #{deductionsObjectType,jdbcType=VARCHAR},
			is_ABC = #{isABC,jdbcType=VARCHAR},
			drawee_bank_name = #{draweeBankName,jdbcType=VARCHAR},
			drawee_bank_account = #{draweeBankAccount,jdbcType=VARCHAR},
			drawee_bank = #{draweeBank,jdbcType=VARCHAR},
			large_line_No = #{largeLineNo,jdbcType=VARCHAR},
			spouse_position = #{spousePosition,jdbcType=VARCHAR},
			spouse_phone2 = #{spousePhone2,jdbcType=VARCHAR},
			
			appli_health = #{appliHealth,jdbcType=VARCHAR},
			appli_residence = #{appliResidence,jdbcType=VARCHAR},
			appli_work = #{appliWork,jdbcType=VARCHAR},
			income_source = #{incomeSource,jdbcType=VARCHAR},
			piscale = #{piscale,jdbcType=VARCHAR},
			month_economy = #{monthEconomy,jdbcType=VARCHAR},
			house_stat = #{houseStat,jdbcType=VARCHAR},
			house_source = #{houseSource,jdbcType=VARCHAR},
			house_type = #{houseType,jdbcType=VARCHAR},
			family_sts = #{familySts,jdbcType=VARCHAR},
			family_year = #{familyYear,jdbcType=VARCHAR},
			repay_rec = #{repayRec,jdbcType=VARCHAR},
			pub_rec = #{pubRec,jdbcType=VARCHAR},
			oth_rec = #{othRec,jdbcType=VARCHAR},
			remark = #{remark,jdbcType=VARCHAR},
			sum_score = #{sumScore,jdbcType=VARCHAR},
			credit_man_code = #{creditManCode,jdbcType=VARCHAR},
			credit_flag = #{creditFlag,jdbcType=VARCHAR},
			company_zip = #{companyZip,jdbcType=VARCHAR},
			company_tel_code = #{companyTelCode,jdbcType=VARCHAR},
			company_tel = #{companyTel,jdbcType=VARCHAR},
			apply_purpose = #{applyPurpose,jdbcType=VARCHAR},
			monthly_wages = #{monthlyWages,jdbcType=VARCHAR},
			moth_ep = #{mothEp,jdbcType=VARCHAR},
			unit_type = #{unitType,jdbcType=VARCHAR},
			employment = #{employment,jdbcType=VARCHAR},
			department = #{department,jdbcType=VARCHAR},
			year_income = #{yearIncome,jdbcType=VARCHAR},
			appliId_email = #{appliIdEmail,jdbcType=VARCHAR},
			appli_post = #{appliPost,jdbcType=VARCHAR},
			family_telcode = #{familyTelcode,jdbcType=VARCHAR},
			payment_acctno = #{paymentAcctno,jdbcType=VARCHAR},
			idvalid_start = #{idvalidStart,jdbcType=VARCHAR},
			idvalid_end = #{idvalidEnd,jdbcType=VARCHAR},
			iss_ctry = #{issCtry,jdbcType=VARCHAR},	
			appli_age = #{appliAge,jdbcType=VARCHAR},
			positions = #{positions,jdbcType=VARCHAR},
			last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
			last_update_date = sysdate()
		WHERE
			customer_Id = #{customerId,jdbcType=VARCHAR}
	</update>
	
</mapper>